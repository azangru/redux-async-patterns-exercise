# Установка

(0) Установить node.js (желательно последнюю версию)

Для этого:

- поставить пакет nvm (node version manager)

(см. инструкцию здесь: https://github.com/creationix/nvm#install-script)

`curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.32.0/install.sh | bash`

- поставить node.js

`nvm install v6.6.0`

- убедиться, что node.js установлен, прописан в PATH, и используется правильная версия из nvm:

`node -v`
(должно вывестись v6.6.0)

- если команда `node -v` выводит старую версию node.js, то переключиться на новую:

`nvm list`
(выводит доступные версии)

`nvm use v6.6.0`
(выбираем нужную версию)

`nvm alias default node`
(выполняется после переключения на нужную версию; после этого в любой терминальной сессии будет использоваться данная версия node.js)

(1) Разархивировать архив в нужную папку, после чего установить пакеты node.js командой:

`npm install`

(2) Собрать клиентские пакеты командой

`npm run build`

(3) Запустить сервер командой

`npm run backend`

==========================
For local development:

# Перечень npm-скриптов

- `npm run clean` — очистка директории public (в которую кладется сборка)
- `npm start` — запуск вебпака в режиме watch для сборки клиентских файлов для разработки (автоматически выполняется скрипт `prestart`, который запускает скрипты `clean` и `prepare-config`)
- `npm run prepare-config` — запуск галпа для сборки конфигурационного файла (дефолтный конфигурационный файл config.js из корня сливается с файлом squirrel_dev_config.js из директории выше (если он есть))
- `npm run prepare-config` — запуск Webpack Dev Server; пока эта команда бесполезна
- `npm run build` — сборка клиентских файлов для боя; включает минификацию и передачу реакту переменной NODE_ENV='production' (автоматически выполняется скрипт `prebuild`, который запускает скрипты `clean` и `prepare-config`)
- `npm test` — запуск тестов (Mocha настроена на файлы, оканчивающиеся на `.spec.js`; реальных тестов нет; один пробный тест — в файле tests/app.spec.js)
- `npm run backend-dev` — запуск бэкенда для разработки (1 процесс node.js; при изменениях в js-файлах сервер перезагружается)
- `npm run backend` — запуск бэкенда для боя (кластер процессов node.js; при единичных ошибках сервер перезагружается)

# Проксирование запросов к api

Сейчас серверный js настроен так, что все запросы к api будут проксироваться на маршрут /api на указанном в конфиге хосте, но если есть желание, можно проксировать запросы с помощью, например, Nginx-а:

```
server {
    listen 8080;
    location / {
      proxy_pass <path_to_node_server>;
    }
    location /api/ {
      proxy_pass <path_to_django_server>;
    }
}
```

# Разное

Добавлен файл `.nvmrc`. Если через nvm установлена соответствующая версия ноды, то, когда переходишь в папку, содержащую .nvmrc и вводишь команду `nvm use`, nvm переключает версию ноды на ту, которая указана в файле.
